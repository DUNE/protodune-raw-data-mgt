digraph pdrnotifier {
	label="Mediated File System Poll with Optional Metadata Producer Design";
	rankdir=LR;
	
	processes[label="Process"];
	file[label="File or\nnetwork",shape=box];
	server[label="Server",shape=octagon];


	daq1[label="DAQ EB1"];
	daq2[label="DAQ EB2"];
	daqn[label="DAQ EBN"];
	

	fifo[shape=box,label="FIFO",color=red];
	notifier[label="Notifier",color="purple"];
	mdfp[label="Metadata\nfile producer",color="purple"];
	
	xrootdrdr[shape=octagon,label="XRootD\nredirector",color=red]
	xrootd[shape=octagon,label="XRootD\nserver N",color=red]
	eos[shape=octagon,label="EOS"]

	xrdfs[shape=box,label="XRootD\ndirectories",color=red];
	ftsfs[shape=box,label="F-FTS/dropbox",color=blue];
	mvln[shape=diamond,label="mv/ln",color=purple];
	
	
	db[shape=box, label="DB"];

	fts[shape=octagon,label="F-FTS",color="blue"];
	sam[shape=octagon,label="SAM",color="orange"];

	{rank="same"; xrootdrdr; xrootd; eos; fts}
	{rank="same"; notifier; mdfp}

	{rank="same"; fifo; xrdfs; mvln; ftsfs}
	

	daq1->xrootdrdr[style=dashed];
	xrootdrdr->xrootd[style=dashed];

	daq1->xrootd[label="TFile::Open()"];
	daq2->xrootd[label="xrdcp"];
	daqn->xrootd[label="..."];

	xrootd->fifo[label="file state"];
	fifo->notifier[label="select()/poll()"];

	notifier->mdfp->notifier[style=dashed];
	notifier->xrootdrdr[style=dashed,label="metadata file"];
	notifier->db[label="monitoring"];

	fts->xrootdrdr[label="xrdcp --tpc"];
	fts->sam[label="update"];
	
	xrootd->xrdfs[label="write()", constraint=false];
	notifier->mvln[constraint=false];

	xrdfs->mvln->ftsfs[style=dotted];
	
	fts->ftsfs[style=dotted, label="ls", constraint=false, color=blue, fontcolor=blue];
	
	

	xrootd->eos[label="transfer"];
}